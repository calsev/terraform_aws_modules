module "secret" {
  source                                      = "../../secret/random"
  name_append_default                         = var.name_append_default
  name_include_app_fields_default             = var.name_include_app_fields_default
  name_infix_default                          = var.name_infix_default
  name_prefix_default                         = var.name_prefix_default
  name_prepend_default                        = var.name_prepend_default
  name_suffix_default                         = var.name_suffix_default
  secret_is_param_default                     = var.secret_is_param_default
  secret_map                                  = local.lx_map
  secret_random_init_key_default              = var.secret_random_init_key_default
  secret_random_init_map_default              = var.secret_random_init_map_default
  secret_random_init_type_default             = var.secret_random_init_type_default
  secret_random_init_value_map                = var.secret_random_init_value_map
  secret_random_special_character_set_default = var.secret_random_special_character_set_default
  std_map                                     = var.std_map
}

module "lambda" {
  source                                  = "../../lambda/function"
  function_ephemeral_storage_mib_default  = 512
  function_map                            = local.create_lambda_map
  function_source_package_handler_default = "accept_vulnerability.lambda_handler"
  function_source_package_runtime_default = "python3.13"
  function_timeout_seconds_default        = var.function_timeout_seconds_default
  iam_data                                = var.iam_data
  log_group_class_default                 = var.log_group_class_default
  log_kms_key_id_default                  = var.log_kms_key_id_default
  log_retention_days_default              = var.log_retention_days_default
  monitor_data                            = var.monitor_data
  std_map                                 = var.std_map
  vpc_az_key_list_default                 = var.vpc_az_key_list_default
  vpc_data_map                            = var.vpc_data_map
  vpc_key_default                         = var.vpc_key_default
  vpc_security_group_key_list_default     = var.vpc_security_group_key_list_default
  vpc_segment_key_default                 = var.vpc_segment_key_default
}

module "trigger" {
  source                              = "../../event/trigger/base"
  event_map                           = local.create_trigger_map
  event_target_service_default        = "lambda"
  iam_data                            = var.iam_data
  monitor_data                        = var.monitor_data
  std_map                             = var.std_map
  vpc_az_key_list_default             = var.vpc_az_key_list_default
  vpc_data_map                        = var.vpc_data_map
  vpc_key_default                     = var.vpc_key_default
  vpc_security_group_key_list_default = var.vpc_security_group_key_list_default
  vpc_segment_key_default             = var.vpc_segment_key_default
}
