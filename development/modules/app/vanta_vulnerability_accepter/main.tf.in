module "secret" {
  source                          = "../../secret/random"
  {{ name.map_item() }}
  {{ secret.map_item() }}
  std_map                         = var.std_map
}

module "lambda" {
  source                                  = "../../lambda/function"
  function_ephemeral_storage_mib_default  = 512
  function_map                            = local.create_lambda_map
  function_source_package_handler_default = "accept_vulnerability.lambda_handler"
  function_source_package_runtime_default = "python3.13"
  function_timeout_seconds_default        = var.function_timeout_seconds_default
  iam_data                                = var.iam_data
  monitor_data                            = var.monitor_data
  std_map                                 = var.std_map
  {{ vpc.map_item() }}
}

module "trigger" {
  source                       = "../../event/trigger/base"
  event_map                    = local.create_trigger_map
  event_target_service_default = "lambda"
  iam_data                     = var.iam_data
  monitor_data                 = var.monitor_data
  std_map                      = var.std_map
  {{ vpc.map_item() }}
}
