variable "event_schedule_expression_default" {
  type        = string
  default     = "rate(1 hour)"
  description = "Either Cron expression or event pattern is required"
}

variable "function_timeout_seconds_default" {
  type        = number
  default     = 15 * 60
  description = "This can take time for many vulnerabilities"
}

variable "iam_data" {
  type = object({
    iam_policy_arn_batch_submit_job = string
    iam_policy_arn_ecs_start_task   = string
    iam_policy_arn_lambda_vpc       = string
  })
}

variable "monitor_data" {
  type = object({
    alert = object({
      topic_map = map(object({
        topic_arn = string
      }))
    })
  })
}

{{ name.var() }}

{{ secret.var(
  key="access_token",
  map={
    "oath_client_id": "INSERT CLIENT ID",
    "oath_client_secret": "INSERT CLIENT SECRET",
  }
) }}

variable "severity_level_list_to_accept" {
  type        = list(string)
  default     = [
    "HIGH",
    "LOW",
    "MEDIUM",
  ]
}

{{ std.map() }}

{{ vpc.var(map_default="null", map_desc="Must be provided if any function is configured in a VPC") }}
