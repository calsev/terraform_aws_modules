locals {
  service_resource_access_action_raw = {
    # These are the actions typically taken by services, so not creation or configuration
    # See https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html
    batch = {
      compute-environment = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      job = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "CancelJob",
          "TagResource",
          "UntagResource",
        ]
      }
      job-definition = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "SubmitJob",
          "TagResource",
          "TerminateJob",
          "UntagResource",
        ]
      }
      job-queue = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "SubmitJob",
          "TagResource",
          "UntagResource",
        ]
      }
      #scheduling-policy
      star = {
        read = [
          "DescribeComputeEnvironments",
          "DescribeJobDefinitions",
          "DescribeJobQueues",
          "DescribeJobs",
          "ListJobs",
        ]
        write = [
        ]
      }
    }
    bedrock = {
      agent = {
        read = [
          "GetAgent",
          "GetAgentActionGroup",
          "GetAgentKnowledgeBase",
          "GetAgentVersion",
          "ListAgentActionGroups",
          "ListAgentAliases",
          "ListAgentKnowledgeBases",
          "ListAgentVersions",
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      agent-alias = {
        read = [
          "GetAgentAlias",
          "GetAgentMemory",
          "ListTagsForResource",
        ]
        write = [
          "InvokeAgent",
          "TagResource",
          "UntagResource",
        ]
      }
      application-inference-profile = {
        read = [
          "GetInferenceProfile",
          "ListTagsForResource",
        ]
        write = [
          "InvokeModel",
          "InvokeModelWithResponseStream",
          "TagResource",
          "UntagResource",
        ]
      }
      custom-model = {
        read = [
          "GetCustomModel",
          "ListTagsForResource",
        ]
        write = [
          "CreateEvaluationJob",
          "CreateModelCustomizationJob",
          "CreateModelEvaluationJob",
          "CreateModelInvocationJob",
          "TagResource",
          "UntagResource",
        ]
      }
      evaluation-job = {
        read = [
          "GetEvaluationJob",
          "ListTagsForResource",
        ]
        write = [
          "StopEvaluationJob",
          "TagResource",
          "UntagResource",
        ]
      }
      foundation-model = {
        read = [
          "GetFoundationModel",
        ]
        write = [
          "CreateEvaluationJob",
          "CreateModelCustomizationJob",
          "CreateModelEvaluationJob",
          "CreateModelInvocationJob",
          "DetectGeneratedContent",
          "InvokeModel",
          "InvokeModelWithResponseStream",
        ]
      }
      inference-profile = {
        read = [
          "GetInferenceProfile",
        ]
        write = [
          "InvokeModel",
          "InvokeModelWithResponseStream",
        ]
      }
      knowledge-base = {
        read = [
          "GetAgentKnowledgeBase",
          "GetDataSource",
          "GetIngestionJob",
          "GetKnowledgeBase",
          "GetKnowledgeBaseDocuments",
          "ListDataSources",
          "ListIngestionJobs",
          "ListKnowledgeBaseDocuments",
          "ListTagsForResource",
          "Retrieve",
        ]
        write = [
          "AssociateAgentKnowledgeBase",
          "CreateDataSource",
          "DeleteDataSource",
          "DeleteKnowledgeBase",
          "DeleteKnowledgeBaseDocuments",
          "DisassociateAgentKnowledgeBase",
          "IngestKnowledgeBaseDocuments",
          "StartIngestionJob",
          "StopIngestionJob",
          "TagResource",
          "UntagResource",
          "UpdateAgentKnowledgeBase",
          "UpdateDataSource",
          "UpdateKnowledgeBase",
        ]
      }
      model-customization-job = {
        read = [
          "GetModelCustomizationJob",
          "ListTagsForResource",
        ]
        write = [
          "StopModelCustomizationJob",
          "TagResource",
          "UntagResource",
        ]
      }
      model-evaluation-job = {
        read = [
          "GetModelEvaluationJob",
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      model-invocation-job = {
        read = [
          "GetModelInvocationJob",
          "ListTagsForResource",
        ]
        write = [
          "StopModelInvocationJob",
          "TagResource",
          "UntagResource",
        ]
      }
      provisioned-model = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "InvokeModel",
          "InvokeModelWithResponseStream",
          "TagResource",
          "UntagResource",
        ]
      }
      star = {
        read = [
          "ListAgents",
          "ListKnowledgeBases",
        ]
        write        = [
          "CreateKnowledgeBase",
        ]
      }
    }
    cloudfront = {
      distribution = {
        read = [
          "GetDistribution",
          "GetInvalidation",
          "ListTagsForResource",
        ]
        write = [
          "CreateInvalidation",
          "ListInvalidations",
          "TagResource",
          "UntagResource",
        ]
      }
      function = {
        read = [
          "DescribeFunction",
        ]
        write = [
          "TestFunction",
        ]
      }
      star = {
        read = [
          "GetPublicKey",
          "ListDistributions",
          "ListFunctions",
          "ListPublicKeys",
          "ListStreamingDistributions",
        ]
        write = [
        ]
      }
      streaming-distribution = {
        read = [
          "GetStreamingDistribution",
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
    }
    codebuild = {
      project = {
        read = [
          "BatchGetBuildBatches",
          "BatchGetBuilds",
          "BatchGetProjects",
          "ListBuildBatchesForProject",
          "ListBuildsForProject",
        ]
        write = [
          "BatchDeleteBuilds",
          "DeleteBuildBatch",
          "InvalidateProjectCache",
          "RetryBuild",
          "RetryBuildBatch",
          "StartBuild",
          "StartBuildBatch",
          "StopBuild",
          "StopBuildBatch",
        ]
      }
      report_group = {
        read = [
          "BatchGetReportGroups",
          "BatchGetReports",
          "DescribeCodeCoverages",
          "DescribeTestCases",
          "GetReportGroupTrend",
          "ListReportsForReportGroup",
        ]
        write = [
          "BatchPutCodeCoverages",
          "BatchPutTestCases",
          "CreateReport",
          "CreateReportGroup",
          "DeleteReport",
          "DeleteReportGroup",
          "UpdateReport",
          "UpdateReportGroup",
        ]
      }
      star = {
        read = [
          "ListBuildBatches",
          "ListBuilds",
          "ListProjects",
          "ListReportGroups",
          "ListReports",
          "ListSharedProjects",
          "ListSharedReportGroups",
        ]
      }
    }
    codedeploy = {
      application = {
        read = [
          "BatchGetApplicationRevisions",
          "BatchGetApplications",
          "GetApplication",
          "GetApplicationRevision",
          "ListApplicationRevisions",
          "ListDeploymentGroups",
          "ListTagsForResource",
        ]
        write = [
          "RegisterApplicationRevision",
          "TagResource",
          "UntagResource",
        ]
      }
      deploymentconfig = {
        read = [
          "GetDeploymentConfig",
        ]
      }
      deploymentgroup = {
        read = [
          "BatchGetDeploymentGroups",
          "BatchGetDeploymentInstances",
          "BatchGetDeployments",
          "GetDeployment",
          "GetDeploymentGroup",
          "GetDeploymentInstance",
          "ListDeploymentInstances",
          "ListDeployments",
          "ListTagsForResource",
        ]
        write = [
          "CreateDeployment",
          "TagResource",
          "UntagResource",
        ]
      }
      instance = {
        read = [
          "BatchGetOnPremisesInstances",
          "GetOnPremisesInstance",
        ]
        write = [
          "AddTagsToOnPremisesInstances",
          "RegisterOnPremisesInstance",
          "RemoveTagsFromOnPremisesInstances",
        ]
      }
      star = {
        read = [
          "BatchGetDeploymentTargets",
          "GetDeploymentTarget",
          "ListApplications",
          "ListDeploymentConfigs",
          "ListDeploymentTargets",
          # "ListGitHubAccountTokenNames",
          "ListOnPremisesInstances",
        ]
        write = [
          "ContinueDeployment",
          "CreateCloudFormationDeployment",
          "PutLifecycleEventHookExecutionStatus",
          "SkipWaitTimeForInstanceTermination",
          "StopDeployment",
        ]
      }
    }
    codestar-connections = {
      connection = {
        read = [
          "GetConnection",
          "ListTagsForResource",
        ]
        write = [
          "PassConnection",
          "UseConnection",
        ]
      }
      host = {
        read = [
          "GetHost",
        ]
      }
      star = {
        read = [
          "ListConnections",
          "ListHosts",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
    }
    dynamodb = {
      global-table = {
        read = [
          "DescribeGlobalTable",
        ]
      }
      import = {
        read = [
          "DescribeImport",
        ]
      }
      index = {
        read = [
          "PartiQLInsert",
          "Query",
          "Scan",
        ]
      }
      star = {
        read = [
          "DescribeEndpoints",
          "ListGlobalTables",
          "ListStreams",
          "ListTables",
        ]
      }
      stream = {
        read = [
          "GetRecords",
          "GetShardIterator",
        ]
      }
      table = {
        read = [
          "BatchGetItem",
          "ConditionCheckItem",
          "DescribeExport",
          "DescribeTable",
          "GetItem",
          "ListTagsOfResource",
          "Query",
          "Scan",
        ]
        write = [
          "BatchWriteItem",
          "DeleteItem",
          "ExportTableToPointInTime",
          "ImportTable",
          "PartiQLDelete",
          "PartiQLInsert",
          "PartiQLUpdate",
          "PutItem",
          "RestoreTableToPointInTime",
          "TagResource",
          "UntagResource",
          "UpdateItem",
        ]
      }
    }
    ecr = {
      repo = {
        read = [
          "BatchCheckLayerAvailability",
          "BatchGetImage",
          "DescribeImages",
          "GetDownloadUrlForLayer",
          "ListImages",
          "ListTagsForResource",
        ]
        write = [
          "BatchDeleteImage",
          "BatchImportUpstreamImage",
          "CompleteLayerUpload",
          "InitiateLayerUpload",
          "PutImage",
          "ReplicateImage",
          "TagResource",
          "UntagResource",
          "UploadLayerPart",
        ]
      }
      star = {
        read = [
          "DescribeRepositories",
          "GetAuthorizationToken",
        ]
        write = [
          "GetAuthorizationToken",
        ]
      }
    }
    ecs = {
      capacity-provider = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      cluster = {
        read = [
          "ListContainerInstances",
          "ListTagsForResource",
        ]
        write = [
          "DeregisterContainerInstance",
          "RegisterContainerInstance",
          "TagResource",
          "UntagResource",
        ]
      }
      container-instance = {
        read = [
          "ListTagsForResource",
          "ListTasks",
        ]
        write = [
          "StartTelemetrySession",
          "TagResource",
          "UntagResource",
        ]
      }
      service = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
          "UpdateService",
          "UpdateServicePrimaryTaskSet",
        ]
      }
      star = {
        read = [
        ]
        write = [
        ]
      }
      task = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "StopTask",
          "TagResource",
          "UntagResource",
        ]
      }
      task-definition = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "RunTask",
          "StartTask",
          "TagResource",
          "UntagResource",
        ]
      }
      task-set = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
          "UpdateTaskSet",
        ]
      }
    }
    elasticfilesystem = {
      access-point = {
        read = [
          "DescribeAccessPoints",
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      file-system = {
        read = [
          "ClientMount",
          "DescribeFileSystems",
          "DescribeMountTargets",
          "DescribeTags",
          "ListTagsForResource",
        ]
        write = [
          "ClientRootAccess", # Needed to delete files owned by root
          "ClientWrite",
          "DeleteTags",
          "TagResource",
          "UntagResource",
        ]
      }
    }
    events = {
      api-destination = {
        read = [
        ]
        write = [
          "InvokeApiDestination",
        ]
      }
      event-bus = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "PutEvents",
          "TagResource",
          "UntagResource",
        ]
      }
      star = {
        read = [
          "ListApiDestinations",
          "ListEventBuses",
        ]
        write = [
        ]
      }
    }
    kms = {
      alias = {
        # Only management actions
      }
      key = {
        read = [
          "DescribeKey", # Required for encryption
          "GetPublicKey",
          "ListResourceTags",
        ]
        write = [
          "Decrypt",
          "Encrypt",
          "GenerateDataKey", # Required for encryption
          "GenerateMac",
          "ReEncryptFrom",
          "ReEncryptTo",
          "Sign",
          "TagResource",
          "UntagResource",
          "Verify",
          "VerifyMac",
        ]
      }
      star = {
        read = [
          "ListAliases",
          "ListKeys",
        ]
        write = [
          "GenerateRandom",
        ]
      }
    }
    lambda = {
      function = {
        read = [
          "ListTags",
        ]
        write = [
          "InvokeFunction",
          "InvokeFunctionUrl",
          "TagResource",
          "UntagResource",
        ]
      }
      star = {
        read = [
          "ListFunctions",
        ]
        write = [
        ]
      }
    }
    logs = {
      group = {
        public_read = [
          "DescribeLogStreams",
        ]
        read = [
          "FilterLogEvents",
          "GetLogGroupFields",
          "GetLogRecord",
          "GetQueryResults",
          "ListTagsForResource",
          "ListTagsLogGroup",
          "StartQuery",
        ]
        write = [
          # CreateLogGroup expressly not allowed: do not let services create goofy groups
          "TagLogGroup",
          "TagResource",
          "UntagLogGroup",
          "UntagResource",
        ]
      }
      stream = {
        public_read = [
          "GetLogEvents",
        ]
        write = [
          "CreateLogStream", # Listed incorrectly in docs
          "DeleteLogStream",
          "PutLogEvents",
        ]
      }
      star = {
        read = [
          "DescribeLogGroups",
          "DescribeQueryDefinitions",
          "DescribeQueries",
          "StopQuery",
        ]
      }
    }
    mobileanalytics = {
      star = {
        write = [
          "PutEvents",
        ]
      }
    }
    s3 = {
      bucket = {
        public_read = [
          "GetBucketLocation",
          "ListBucket",
        ]
        read = [
          "GetBucketTagging",
          "ListBucketVersions",
        ]
        public_write = [
        ]
        write = [
          "ListBucket",
          "ListBucketMultipartUploads",
          "PutBucketTagging",
        ]
      }
      object = {
        public_read = [
          "GetObject",
          "GetObjectVersion",
        ]
        read = [
          # "GetObjectAcl",
          "GetObjectTagging",
          # "GetObjectVersionAcl",
          "GetObjectVersionTagging",
        ]
        public_write = [
          "AbortMultipartUpload",
          "ListMultipartUploadParts",
          "PutObject",
        ]
        write = [
          "DeleteObject",
          "DeleteObjectTagging",
          "DeleteObjectVersion",
          "DeleteObjectVersionTagging",
          # "PutObjectAcl",
          "PutObjectTagging",
          # "PutObjectVersionAcl",
          "PutObjectVersionTagging",
          "RestoreObject",
        ]
      }
      star = {
        public_read = [
        ]
        read = [
          "GetAccessPoint",
          "ListAccessPoints",
          "ListAccessPointsForObjectLambda",
          "ListAllMyBuckets",
          "ListJobs",
          "ListMultiRegionAccessPoints",
        ]
        public_write = [
        ]
        write = [
          "CreateJob",
        ]
      }
    }
    secretsmanager = {
      secret = {
        read = [
          "DescribeSecret",
          "GetSecretValue",
          "ListSecretVersionIds",
        ]
        write = [
          "CancelRotateSecret",
          "PutSecretValue",
          "RotateSecret",
          "TagResource",
          "UntagResource",
          "UpdateSecret",
          "UpdateSecretVersionStage",
        ]
      }
      star = {
        read = [
          # "BatchGetSecretValue",
          "GetRandomPassword",
          "ListSecrets",
        ]
      }
    }
    sns = {
      topic = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "Publish",
          "TagResource",
          "UntagResource",
        ]
      }
    }
    sqs = {
      queue = {
        pull = [
          "ChangeMessageVisibility",
          "DeleteMessage",
          "GetQueueAttributes",
          "GetQueueUrl",
          "ReceiveMessage",
        ]
        push = [
          "GetQueueUrl",
          "SendMessage",
        ]
      }
    }
    ssm = {
      parameter = {
        read = [
          "GetParameter",
          "GetParameters",
          "GetParametersByPath",
          "ListTagsForResource",
        ]
        write = [
          "AddTagsToResource",
          "LabelParameterVersion",
          "RemoveTagsFromResource",
          "UnlabelParameterVersion",
        ]
      }
      star = {
        read = [
          "DescribeParameters",
        ]
      }
    }
    states = {
      activity = {
        read = [
          "DescribeActivity",
          "ListTagsForResource",
        ]
        write = [
          #"CreateActivity",
          #"DeleteActivity",
          "GetActivityTask",
          "TagResource",
          "UntagResource",
        ]
      }
      execution = {
        read = [
          "DescribeExecution",
          "DescribeStateMachineForExecution",
          "GetExecutionHistory",
        ]
        write = [
          "StopExecution",
        ]
      }
      state_machine = {
        read = [
          "DescribeStateMachine",
          "ListExecutions",
          "ListTagsForResource",
        ]
        write = [
          #"CreateStateMachine",
          #"DeleteStateMachine",
          "StartExecution",
          "StartSyncExecution",
          "TagResource",
          "UntagResource",
          #"UpdateStateMachine",
        ]
      }
      star = {
        read = [
          "ListActivities",
          "ListStateMachines",
        ]
        write = [
          "SendTaskFailure",
          "SendTaskHeartbeat",
          "SendTaskSuccess",
        ]
      }
    }
    textract = {
      adapter = {
        read = [
          "GetAdapter",
          "ListTagsForResource",
        ]
        write = [
          #"CreateAdapterVersion",
          #"DeleteAdapter",
          "TagResource",
          "UntagResource",
          #"UpdateAdapter",
        ]
      }
      adapterversion = {
        read = [
          "GetAdapterVersion",
          "ListTagsForResource",
        ]
        write = [
          #"DeleteAdapterVersion",
          "TagResource",
          "UntagResource",
        ]
      }
      star = {
        read = [
          "AnalyzeDocument",
          "AnalyzeExpense",
          "AnalyzeID",
          "DetectDocumentText",
          "GetDocumentAnalysis",
          "GetDocumentTextDetection",
          "GetExpenseAnalysis",
          "GetLendingAnalysis",
          "GetLendingAnalysisSummary",
          "ListAdapterVersions",
          "ListAdapters",
        ]
        write = [
          #"CreateAdapter",
          "StartDocumentAnalysis",
          "StartDocumentTextDetection",
          "StartExpenseAnalysis",
          "StartLendingAnalysis",
        ]
      }
    }
    xray = {
      group = {
        read = [
          "GetGroup",
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      sampling_rule = {
        read = [
          "ListTagsForResource",
        ]
        write = [
          "TagResource",
          "UntagResource",
        ]
      }
      star = {
        read = [
          "BatchGetTraces",
          "GetGroups",
          "GetInsight",
          "GetInsightEvents",
          "GetInsightImpactGraph",
          "GetInsightSummaries",
          "GetSamplingRules",
          "GetSamplingStatisticSummaries",
          "GetSamplingTargets",
          "GetServiceGraph",
          "GetTimeSeriesServiceStatistics",
          "GetTraceGraph",
          "GetTraceSummaries",
        ]
        write = [
          "PutTelemetryRecords",
          "PutTraceSegments",
        ]
      }
    }
  }
}
