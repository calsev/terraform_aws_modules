version: 0.2
phases:
  install:
    commands:
      - apt-get update
      - apt-get install -yqq git gnupg2 make software-properties-common wget
      - wget -O- https://apt.releases.hashicorp.com/gpg | 
        gpg --dearmor > 
        /usr/share/keyrings/hashicorp-archive-keyring.gpg
      - gpg --no-default-keyring 
        --keyring /usr/share/keyrings/hashicorp-archive-keyring.gpg 
        --fingerprint
      - echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" > 
        /etc/apt/sources.list.d/hashicorp.list
      - apt-get update
      - apt-get install terraform
      - terraform --version
      - cd development
      - export BASE_PY=$(which python) # Don't bother with Pyenv versions
      - make env-install
  build:
    commands:
      - make lint
